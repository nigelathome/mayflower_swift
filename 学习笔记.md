# Swift学习笔记
[toc]
##Swift简介
###Swift发展历程
* 2010年开始，目前经历了5个版本
* OC从80年代开始目前只有2个版本
* 2015年开源
* 最新版本是2019.3 swift 5.0

###Swift和Objective-C的不同
* Swift支持面向协议编程、函数式编程、面向对象编程；Objective-C主要以面向对象编程
* Swift是类型安全；Objective-C不是

	```
	var str : String
	var a : Int
	str = a //编译间报错 Cannot assign value of type 'Int' to type 'String'
	
	NSString *str = @"";
	NSNumber *num = [NSNumber numberWithInt:7];
	str = num;//编译器仅会警告
	```

* Swift中的Int、Double、Float、String、Array、Dictionary、Set都是值类型；Objective-C中的NSNumber、NSString、NSString、NSArray、NSDictionary、NSSet都是引用类型，NSInteger、CGFloat都是值类型
* Swift枚举类型支持协议、扩展、泛型；Objective-C枚举基于c语言枚举较为简单
* Swift完全支持泛型；Objective-C泛型较为简单
* Swift协议更加丰富，支持值类型和枚举；Objective-C只针对类的协议
* Swift函数可以直接作为返回值类型；Objective-C需要使用selector或block才能实现
* Swift编译前端使用swiftc；Objective-C使用Clang

##基本数据类型
###常量和变量
```
//常量用let声明
let π = 3.14
let key : String = "key"

//变量用var声明
var x = 0.0, y = 1.0, z = 2.0
var name : String
name = "nigelli 2021"
```

###基本数据类型
```
//UInt = NSUInteger, Int = NSInteger 根据平台位数兼容
var num1 : UInt = 7
var num2 : Int = -3

//Float和Double在OC中对应CGFloat，Float 4位、Double 8位
var num3 : Double = -17.0
var num4 : Float = -13.0

var isEmpty : Bool = true

//typedef = typealias
typealias SampleRate = UInt8
let rate : SampleRate = 20
```

###tuple
```
//常量tuple
let compInfo = (url: "www.compass.real.estate.com", location:"NY, US", emp_num: 2000)
print(compInfo.url, compInfo.location, compInfo.emp_num)

//变量tuple
var error = (errorCode: 1, errorMsg: "网络错误")
print(error.errorCode)
print(error.errorMsg)
error.errorCode = 2
print(error.errorCode)

//Any表示任意类型
var callBackTuple : (Any, String) = (1, "没有权限")
print(callBackTuple)
print(callBackTuple.0, callBackTuple.1)

//_表示不需要的显示的参数的占位
var returnValueTuple : (UInt, UInt) = (7, 13)
var (_, returnValueKey) = returnValueTuple
print(returnValueKey)

//tuple做函数返回值
func seekAtInfo(pos: UInt) -> (key: String, value: String) {
    return ("key", "value")
}

var seekInfo = seekAtInfo(pos: 30)
print(seekInfo.key, seekInfo.value)
```

###可选类型（Optional）
```
//可选类型的定义？
var str1: String? = "abc"
if str1 != nil {
//可选类型使用!解包后才能使用其中的值
    let count = str1!.count
    print(String(format: "count=%d", count))
}

var str2: String? = "abc"
if str2 != nil {
	//!等价于使用unsafeUnwrapped解包
    let count = str2.unsafelyUnwrapped.count
    print(String(format: "count=%d", count))
}
```

###字符串
```
//String初始化
var emptyString1 = ""
var emptyString2: String = String()

//判断是否是空串
if emptyString1.isEmpty {
    print(String(format: "emptyString1 is empty"))
}
if emptyString2.isEmpty {
    print(String(format: "emptyString2 is empty"))
}

//多行字面量 使用""" XXX """
let aboutSwift = """
Swift is a powerful and intuitive programming language for iOS, iPadOS, macOS, tvOS, and watchOS. \
Writing Swift code is interactive and fun, the syntax is concise yet expressive, and Swift includes modern features developers love. \
Swift code is safe by design, yet also produces software that runs lightning-fast.
"""
print(aboutSwift)

//可变字符串
var varString: String = "Horse"
varString += " and carriage"

//不可变字符串
let constString: String = "Highlander"

//String是值类型 不同于Objective-C的引用类型
var strA: String = "0710"
var strB: String = strA
print(strA == strB)
strB += "0908"
print(strA)
print(strB)
print(strA == strB)

//for-in 遍历String中的每个字符
for char in "Highlander" {
    print(char)
}

//通过[Character]构造字符串
let charArray: [Character] = ["H", "i", "g", "h", "l", "a", "n", "d", "e", "r"]
let charString: String = String(charArray)
print(charString)

//+和append()拼接字符串
print(charString + "and another highlander")
print(charString.appending("and another highlander"))

//\(A) 输出a的值 实现stringWithFormat用法
let multiplier = 3
let msg = "\(multiplier) times 2.5 is \(Double(multiplier) * 2.5) "

//String索引
let greeting = "Guten Tag!"
greeting[greeting.startIndex]
greeting[greeting.index(before: greeting.endIndex)]
greeting[greeting.index(after: greeting.startIndex)]
let index = greeting.index(greeting.startIndex, offsetBy: 7)
print(greeting[index])

//insert()字符串插入
var tips = "hold on"
tips.insert("!", at: tips.endIndex)
tips.insert(contentsOf: "pls ", at: tips.startIndex)

//move:at()字符串移除
tips.remove(at: tips.index(before: tips.endIndex))
print(tips)

//range获取子串 removeSubrange()删除
let range = tips.index(tips.endIndex, offsetBy: -7)..<tips.endIndex
tips.removeSubrange(range)
print(tips)

//Substring
let greetingWords = "Hello, world!"
let idx = greetingWords.firstIndex(of: ",") ?? greetingWords.endIndex
let subString: Substring = greetingWords[..<idx]
let newString = Substring(subString)
print(newString)

//字符串比较
print(greetingWords == newString)
print(subString != newString)
print(greetingWords.hasPrefix("Hello"))
print(greetingWords.hasSuffix("!"))
```

##运算符
###合并空值运算符

```
//a??b 等价于三元远算 (a != nil ? a!: b)
func addTwoNum(num1: Int?, num2: Int?) -> Int {
    return (num1 ?? 0) + (num2 ?? 0)
}

let sum: Int = addTwoNum(num1: 3, num2: 2)
```

###区间运算符
```
//a...b 等价于[a, b]
for idx in 1...5 {
    print("\(idx) * 5 = \(Int(idx * 5))")
}

//a..<b 等价于[a, b)
let namesArray = ["zhangsan", "lisi", "wangwu", "zhaoliu"]
let cnt = namesArray.count
for i in 0..<cnt {
    print(namesArray[i])
}

//单侧区间
for name in namesArray[2...] {
    print(name)
}

for name in namesArray[...2] {
    print(name)
}

let rangeInt = ...5
rangeInt.contains(7)
rangeInt.contains(4)
rangeInt.contains(-1)
```

##流程控制
###for-in
```
//数组
for name in namesArray {
    print(name)
}

//字典
let dict = ["spider": 8, "ant": 6, "cat": 4]
for (k, v) in dict {
    print("key = \(k), value = \(v)")
    print(String(format: "key = %@, value = %d", k, v))
}

//_忽略临时变量名
let base = 3, power = 5
var answer = 1
for _ in 1...power {
    answer *= base
}
print(answer)

//分段区间
//stride(from:to:by:) 开区间
let minInterval = 5
for mark in stride(from: 0, to: 50, by: minInterval) {
    print(mark)
}
//stride(from:through:by:) 闭区间
for mark in stride(from: 0, through: 50, by: minInterval) {
    print(mark)
}
```

###repeat-while
```
//repeat-while等价于do-while
var count = 0
repeat {
    print(count)
    count += 1
} while count < 5
```

###switch-case
```
//switch-case 不隐式贯穿到下一个case
let anotherChar: Character = "a"
switch anotherChar {
case "a", "A":
    print("the letter A.")
default:
    print("not the letter A.")
}
```

###guard-else
```
//guard-else等价if-else
func isUpperCase(name: String?) {
    guard let tmp = name, tmp.count > 0 else {
        print("name is nil or empty string")
        return
    }
    print("Uppercased:\(tmp.uppercased())")
}

isUpperCase(name: "")
isUpperCase(name: "nigelli")
isUpperCase(name: nil)
```

##集合类
###数组
```
//数组遍历
//forEach()
numbersArray.forEach { (num) in
    if num == 3 {
        print(num * 10)
    }
}

//Iterator
var numIterator = numbersArray.makeIterator()
while let num = numIterator.next() {
    print(num * 10)
}

//indices
for i in numbersArray.indices {
    print(numbersArray[i])
}

//数组查找
var arr2 = [10, 20, 45, 30, 98, 100, 30, 4]
print(arr2.first!)
print(arr2.last!)
print(arr2.first(where: {$0 > 25})!)
print(arr2.last(where: {$0 > 25})!)
print(arr2.firstIndex(of: 30)!)
print(arr2.lastIndex(of: 20)!)

let maxY: Int? = arr2.max()
print(maxY ?? 0)

let minY: Int? = arr2.min()
print(minY ?? 0)

//allSatisfy(_:)数组中是否存在满足条件的元素
var arr = [10, 20, 45, 30, 98, 101, 30, 4]
print(arr.allSatisfy({$0 > 10}))
print(arr.allSatisfy({$0 >= 4}))

//数组添加和删除
arr.append(100)
print(arr)

var num = [Int](2...7)
num.append(contentsOf: 100...105)
print(num)

num.insert(5, at: 3)
num.insert(contentsOf: 10...16, at: 3)
print(num)

var chars: [Character] = ["a", "b", "c"]
chars.insert(contentsOf: "123", at: 0)

let removeChar = chars.remove(at: 1)
print(chars)
let firstChar = chars.removeFirst()
print(chars)

```